<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Path to POLISH â€¢ Avatar Builder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Dual-host <base> -->
  <script>
    (function () {
      var isGH = /\.github\.io$/i.test(location.hostname);
      var baseHref = isGH ? '/LearnPolish/' : '/';
      document.write('<base href="' + baseHref + '">');
    })();
  </script>

  <link rel="stylesheet" href="static/app.css">
  <style>
    body{
      font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Ubuntu,Helvetica,Arial;
      background:#0b0c10;
      color:#e7e9ee;
      margin:0;
    }
    main{
      max-width:900px;
      margin:24px auto 60px;
      padding:0 16px;
    }
    .card{
      background:#121418;
      border-radius:16px;
      border:1px solid #1e2230;
      padding:16px;
      box-shadow:0 8px 24px rgba(0,0,0,.5);
    }
    .row{ display:flex; gap:12px; flex-wrap:wrap; align-items:center; }
    .tiny{ font-size:12px; opacity:.8; }
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:6px 12px;
      border-radius:999px;
      border:1px solid #2f3545;
      background:#111827;
      color:#e7e9ee;
      font-size:13px;
      cursor:pointer;
    }
    .btn.active{
      background:#2d6cdf;
      border-color:transparent;
    }
    #previewBox{
      width:180px;
      height:180px;
      border-radius:24px;
      border:1px solid #1e2230;
      background:#020617;
      display:flex;
      align-items:center;
      justify-content:center;
      margin-bottom:12px;
    }
  </style>
</head>
<body>
  <main>
    <section class="card">
      <h2 style="margin:0 0 8px;">Avatar Builder Preview</h2>
      <p class="tiny" style="margin-bottom:12px;">
        Choose a pierogi type + mood to sanity check your SVG faces alignment.
      </p>

      <div id="previewBox">
        <div id="avatarPreview" style="width:140px; height:140px;"></div>
      </div>

      <div class="row" style="margin-bottom:10px;">
        <span class="tiny">Character:</span>
        <button type="button" class="btn char-btn" data-id="hero">Hero</button>
        <button type="button" class="btn char-btn" data-id="chonky">Chonky</button>
        <button type="button" class="btn char-btn" data-id="tall">Tall</button>
        <button type="button" class="btn char-btn" data-id="junior">Junior</button>
      </div>

      <div class="row">
        <span class="tiny">Mood:</span>
        <button type="button" class="btn mood-btn" data-mood="neutral">Neutral</button>
        <button type="button" class="btn mood-btn" data-mood="win">Win</button>
        <button type="button" class="btn mood-btn" data-mood="milestone">Milestone</button>
        <button type="button" class="btn mood-btn" data-mood="tired">Tired</button>
        <button type="button" class="btn mood-btn" data-mood="embarrassed">Embarrassed</button>
        <button type="button" class="btn mood-btn" data-mood="inactive">Inactive</button>
      </div>
    </section>
  </main>

  <script src="static/js/app-config.js"></script>
  <script src="static/js/avatar.js"></script>
  <script>
    (function () {
      const preview = document.getElementById('avatarPreview');
      const charBtns = Array.from(document.querySelectorAll('.char-btn'));
      const moodBtns = Array.from(document.querySelectorAll('.mood-btn'));

      let currentChar = 'hero';
      let currentMood = 'neutral';

      function syncButtons() {
        charBtns.forEach(b => {
          b.classList.toggle('active', b.dataset.id === currentChar);
        });
        moodBtns.forEach(b => {
          b.classList.toggle('active', b.dataset.mood === currentMood);
        });
      }

      function redraw() {
        if (window.AvatarChooser) {
          AvatarChooser.renderAvatar(preview, currentChar, currentMood);
        }
      }

      charBtns.forEach(b => {
        b.addEventListener('click', () => {
          currentChar = b.dataset.id || 'hero';
          syncButtons();
          redraw();
        });
      });

      moodBtns.forEach(b => {
        b.addEventListener('click', () => {
          currentMood = b.dataset.mood || 'neutral';
          syncButtons();
          redraw();
        });
      });

      syncButtons();
      redraw();
    })();
  </script>
</body>
</html>
