<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Path to POLISH • Avatar Builder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Dual-host <base> (GitHub Pages vs Flask/Render) -->
  <script>
    (function () {
      var isGH   = /\.github\.io$/i.test(location.hostname);
      var isFile = location.protocol === 'file:';
      var baseHref;

      if (isGH) {
        // GitHub Pages → /LearnPolish/ as before
        baseHref = '/LearnPolish/';
      } else if (isFile) {
        // Local file mode → keep URLs relative to the folder
        baseHref = '';
      } else {
        // Flask / localhost / Render → root
        baseHref = '/';
      }

      document.write('<base href="' + baseHref + '">');
    })();
  </script>


  <link rel="stylesheet" href="static/app.css" />
  <style>
    :root {
      --brand:#2d6cdf;
      --bg:#0b1120; --card:#020617; --border:#1f2937;
      --text:#e5e7eb; --muted:#9ca3af;
      --shadow:0 18px 40px rgba(0,0,0,.6);
      --radius:18px; --pad:16px;
    }
    *{ box-sizing:border-box }
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Ubuntu,Helvetica,Arial;
      background:radial-gradient(circle at top,#1f2937 0,#020617 55%,#000 100%);
      color:var(--text);
    }
    main{
      max-width:1100px;
      margin:20px auto 40px;
      padding:0 16px;
      display:grid;
      grid-template-columns:minmax(0,1.1fr) minmax(0,1.3fr);
      gap:18px;
    }
    @media (max-width:960px){
      main{ grid-template-columns:1fr; }
    }
    .card{
      background:linear-gradient(135deg,rgba(15,23,42,.96),rgba(15,23,42,.92));
      border-radius:var(--radius);
      border:1px solid var(--border);
      box-shadow:var(--shadow);
      padding:var(--pad);
    }
    h1{
      margin:0 0 4px;
      font-size:clamp(20px,3.6vw,26px);
    }
    .muted{ color:var(--muted); font-size:13px; }

    .preview-wrap{
      display:flex;
      flex-direction:column;
      gap:12px;
      align-items:center;
      justify-content:center;
    }
    .avatar-frame{
      width:260px;
      height:260px;
      border-radius:28px;
      overflow:hidden;
      border:1px solid rgba(148,163,184,.4);
      background:#020617;
      box-shadow:0 16px 32px rgba(15,23,42,.9);
    }
    .avatar-frame svg{
      width:100%;
      height:100%;
      display:block;
    }

    .row{ display:flex; flex-wrap:wrap; gap:10px; align-items:center; }
    .section{
      margin-bottom:14px;
      border-top:1px solid rgba(148,163,184,.2);
      padding-top:10px;
    }
    .section:first-of-type{
      border-top:none;
      padding-top:0;
    }
    .section h3{
      margin:0 0 4px;
      font-size:14px;
      font-weight:600;
      text-transform:uppercase;
      letter-spacing:.08em;
      color:#e5e7eb;
    }
    .section .muted{ margin-bottom:4px; }

    .chip{
      border-radius:999px;
      padding:6px 10px;
      border:1px solid rgba(148,163,184,.6);
      background:rgba(15,23,42,.9);
      color:var(--text);
      font-size:12px;
      display:inline-flex;
      align-items:center;
      gap:6px;
      cursor:pointer;
      transition:background .12s ease, border-color .12s ease, transform .06s ease;
    }
    .chip span.label{ font-weight:500; }
    .chip:hover{
      transform:translateY(-1px);
      border-color:var(--brand);
    }
    .chip.active{
      background:rgba(37,99,235,.25);
      border-color:var(--brand);
      box-shadow:0 0 0 1px rgba(37,99,235,.4);
    }
    .chip svg{
      width:22px;
      height:22px;
      border-radius:999px;
      background:#020617;
    }

    .codebox{
      font-family:ui-monospace,Menlo,Consolas,monospace;
      font-size:12px;
      padding:8px 10px;
      border-radius:10px;
      background:#020617;
      border:1px solid rgba(148,163,184,.3);
      color:#e5e7eb;
      overflow-x:auto;
      white-space:nowrap;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.5);
      padding:4px 8px;
      font-size:11px;
      gap:6px;
    }
    .pill-dot{
      width:6px; height:6px;
      border-radius:999px;
      background:#22c55e;
    }
  </style>
</head>
<body>
  <main>
    <!-- LEFT: Preview -->
    <section class="card preview-wrap">
      <div>
        <h1>Avatar builder (prototype)</h1>
        <div class="muted">
          Mix backgrounds, faces, hair and accessories. Later this will wire into your profile.
        </div>
      </div>

      <div class="avatar-frame" id="avatarPreview"></div>

      <div class="row">
        <div class="pill">
          <span class="pill-dot"></span>
          <span>Profile will store something like:</span>
        </div>
      </div>
      <div class="codebox" id="avatarCodeBox"></div>
    </section>

    <!-- RIGHT: Controls -->
    <section class="card">
      <div class="section">
        <h3>Background</h3>
        <div class="muted">World / mood behind the character.</div>
        <div class="row" data-part="bg">
          <button class="chip" data-id="bg-soft">
            <svg viewBox="0 0 64 64">
              <use href="static/avatar/parts.svg#bg-soft"></use>
            </svg>
            <span class="label">Soft night</span>
          </button>
          <button class="chip" data-id="bg-gold">
            <svg viewBox="0 0 64 64">
              <use href="static/avatar/parts.svg#bg-gold"></use>
            </svg>
            <span class="label">Gold focus</span>
          </button>
          <button class="chip" data-id="bg-ocean">
            <svg viewBox="0 0 64 64">
              <use href="static/avatar/parts.svg#bg-ocean"></use>
            </svg>
            <span class="label">Ocean</span>
          </button>
        </div>
      </div>

      <div class="section">
        <h3>Face</h3>
        <div class="muted">Shape and skin tone.</div>
        <div class="row" data-part="face">
          <button class="chip" data-id="face-round">
            <svg viewBox="0 0 64 64">
              <use href="static/avatar/parts.svg#face-round"></use>
            </svg>
            <span class="label">Warm round</span>
          </button>
          <button class="chip" data-id="face-oval">
            <svg viewBox="0 0 64 64">
              <use href="static/avatar/parts.svg#face-oval"></use>
            </svg>
            <span class="label">Bright oval</span>
          </button>
          <button class="chip" data-id="face-deep">
            <svg viewBox="0 0 64 64">
              <use href="static/avatar/parts.svg#face-deep"></use>
            </svg>
            <span class="label">Deep tone</span>
          </button>
        </div>
      </div>

      <div class="section">
        <h3>Hair</h3>
        <div class="muted">General silhouette — you can refine shapes later.</div>
        <div class="row" data-part="hair">
          <button class="chip" data-id="hair-short">
            <svg viewBox="0 0 64 64">
              <use href="static/avatar/parts.svg#hair-short"></use>
            </svg>
            <span class="label">Short</span>
          </button>
          <button class="chip" data-id="hair-long">
            <svg viewBox="0 0 64 64">
              <use href="static/avatar/parts.svg#hair-long"></use>
            </svg>
            <span class="label">Long</span>
          </button>
          <button class="chip" data-id="hair-curly">
            <svg viewBox="0 0 64 64">
              <use href="static/avatar/parts.svg#hair-curly"></use>
            </svg>
            <span class="label">Curly</span>
          </button>
        </div>
      </div>

      <div class="section">
        <h3>Eyes</h3>
        <div class="muted">A bit of personality.</div>
        <div class="row" data-part="eyes">
          <button class="chip" data-id="eyes-smile">
            <svg viewBox="0 0 64 64">
              <use href="static/avatar/parts.svg#eyes-smile"></use>
            </svg>
            <span class="label">Smiling</span>
          </button>
          <button class="chip" data-id="eyes-focused">
            <svg viewBox="0 0 64 64">
              <use href="static/avatar/parts.svg#eyes-focused"></use>
            </svg>
            <span class="label">Focused</span>
          </button>
          <button class="chip" data-id="eyes-sleepy">
            <svg viewBox="0 0 64 64">
              <use href="static/avatar/parts.svg#eyes-sleepy"></use>
            </svg>
            <span class="label">Chill</span>
          </button>
        </div>
      </div>

      <div class="section">
        <h3>Mouth</h3>
        <div class="muted">Expression.</div>
        <div class="row" data-part="mouth">
          <button class="chip" data-id="mouth-soft-smile">
            <span class="label">Soft smile</span>
          </button>
          <button class="chip" data-id="mouth-big-smile">
            <span class="label">Big smile</span>
          </button>
          <button class="chip" data-id="mouth-think">
            <span class="label">Thinking</span>
          </button>
        </div>
      </div>

      <div class="section">
        <h3>Accessory</h3>
        <div class="muted">Optional layer on top.</div>
        <div class="row" data-part="acc">
          <button class="chip" data-id="">
            <span class="label">None</span>
          </button>
          <button class="chip" data-id="acc-glasses">
            <span class="label">Glasses</span>
          </button>
          <button class="chip" data-id="acc-headphones">
            <span class="label">Headphones</span>
          </button>
          <button class="chip" data-id="acc-book">
            <span class="label">Book</span>
          </button>
        </div>
      </div>
    </section>
  </main>

  <script>
    // State: which symbol id is selected for each layer
    const spritePath = "static/avatar/parts.svg";
    const state = {
      bg: "bg-soft",
      face: "face-round",
      hair: "hair-short",
      eyes: "eyes-smile",
      mouth: "mouth-soft-smile",
      acc: ""
    };

    function updatePreview() {
      const wrap = document.getElementById("avatarPreview");
      if (!wrap) return;

      const parts = [];
      parts.push(`<use href="${spritePath}#${state.bg}"></use>`);
      parts.push(`<use href="${spritePath}#${state.face}"></use>`);
      parts.push(`<use href="${spritePath}#${state.hair}"></use>`);
      parts.push(`<use href="${spritePath}#${state.eyes}"></use>`);
      parts.push(`<use href="${spritePath}#${state.mouth}"></use>`);
      if (state.acc) {
        parts.push(`<use href="${spritePath}#${state.acc}"></use>`);
      }

      wrap.innerHTML =
        `<svg viewBox="0 0 512 512" aria-label="Avatar preview" role="img">
          ${parts.join("\n")}
        </svg>`;

      const codeBox = document.getElementById("avatarCodeBox");
      if (codeBox) {
        const payload = {
          bg: state.bg,
          face: state.face,
          hair: state.hair,
          eyes: state.eyes,
          mouth: state.mouth,
          acc: state.acc || null
        };
        codeBox.textContent = JSON.stringify(payload);
      }
    }

    function wireControls() {
      document.querySelectorAll("[data-part]").forEach(group => {
        const partName = group.getAttribute("data-part");
        group.addEventListener("click", ev => {
          const chip = ev.target.closest(".chip");
          if (!chip) return;
          const id = chip.getAttribute("data-id") || "";
          state[partName] = id;

          // update active styling in this group
          group.querySelectorAll(".chip").forEach(btn => {
            btn.classList.toggle("active", btn === chip);
          });

          updatePreview();
        });

        // mark first chip in each group active initially
        const firstChip = group.querySelector(".chip");
        if (firstChip) firstChip.classList.add("active");
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      wireControls();
      updatePreview();
    });
  </script>
</body>
</html>
